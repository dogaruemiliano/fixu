function refreshForm(innerHTML) {
  const form = document.getElementById('reviewModal-<%= @appointment.id %>');
  form.innerHTML = innerHTML;
}

function closeModal() {
  const buttons = document.querySelectorAll('.close');
  buttons.forEach( button =>
    button.click()
  );
}

function removeButton() {
  const button = document.querySelector('#review-<%= @appointment.id %>');
  button.remove();
}

<% if @review.errors.any? %>
  refreshForm('<%= j render "reviews/form", appointment: @appointment, review: @review %>');
<% else %>
  closeModal();
  removeButton();
  refreshForm('<%= j render "reviews/form", appointment: @appointment, review: Review.new %>');
<% end %>
