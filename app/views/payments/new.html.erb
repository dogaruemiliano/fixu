<% content_for(:navbar) do %>
  <%= render "shared/navbar2" %>
<% end %>

<div class="container my-4">
  <div class="row">
    <div class="col-12">
      <h2>Checkout summary</h2>
      <p>Payment for your appointement with <strong><%= @appointment.fixer.user.full_name %></strong> for <strong><%= humanized_money_with_symbol @appointment.amount %></strong></p>
      <button id="pay" class="btn btn-lg">Proceed to checkout</button>
    </div>
  </div>
</div>
<script src="https://js.stripe.com/v3/"></script>
<script>
  const paymentButton = document.getElementById('pay');
  paymentButton.addEventListener('click', () => {
    const stripe = Stripe('<%= ENV['STRIPE_PUBLISHABLE_KEY'] %>');
    stripe.redirectToCheckout({
      sessionId: '<%= @appointment.checkout_session_id %>'
    });
  });
</script>
